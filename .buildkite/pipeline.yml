
steps:

  - label: "define if for full test suite"
    if: build.pull_request.base_branch == "develop" && !build.pull_request.draft
    commands:
      - buildkite-agent meta-data set "full_test_suite" "true"
      - echo NEON_EVM_PR_DEVELOP=${BUILDKITE_PULL_REQUEST} > neon_evm_pipeline.env
      - echo BUILDKITE_JOB_ID - ${BUILDKITE_JOB_ID}
    agents:
      queue: "testing"
    artifact_paths:
      - "neon_evm_pipeline.env"

  - wait

  - label: "print environment"
    commands:
      - echo $(buildkite-agent meta-data get "full_test_suite" --default "false") > neon_evm_pipeline_data.env
      - echo BUILDKITE_JOB_ID - ${BUILDKITE_JOB_ID}
    agents:
      queue: "testing"
    artifact_paths:
      - "neon_evm_pipeline.env"

  - wait

  - label: ":docker: trigger python logged groups pipeline"
    trigger: "rozhkovdmitrii-sanbox-pipeline"

    build:
      branch: "play-buildkite"
      env:
          EVM_LOADER_REVISION: "${BUILDKITE_COMMIT}"
          EVM_LOADER_BRANCH: "${EVM_LOADER_BRANCH}"
          SOLANA_REVISION: "v1.8.12-testnet"
          FULL_TEST_SUITE: "buildkite-agent meta-data get \"full_test_suite\" --default \"false\""

      meta_data:
        NEON_EVM_JOB_ID: "${BUILDKITE_JOB_ID}"
        full_test_suite: adsf


